import{r as I,o as h,c as k,a as g,b as S,d as L,e as y,f as m,F as N,g as O,h as A,u as E,n as F,t as M,i as V,j as B,k as H,l as P}from"./modules-79d55945.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const f of t.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}})();const w=(d,o)=>{const n=d.__vccOpts||d;for(const[i,e]of o)n[i]=e;return n},R={};function j(d,o){const n=I("RouterView");return h(),k(n)}const U=w(R,[["render",j]]);const q={class:"container"},z={class:"grid"},D=1,K=-1,W={__name:"HomeView",setup(d){const o=g([]),n=S({lotteryCount:0});L(()=>{});const i=g(null),e=g(null),t=s=>{i.value=s.target.files[0]},f=s=>{let a=-1,c=-1;for(let u=0;u<s.length;u++){const p=s[u];for(let l=0;l<p.length;l++)if(p[l]==="姓名"){a=l,c=u,console.log("找到");break}if(a!==-1)break}const r={};return a!==-1&&c!==-1?(r.msg=1,r.colIndex=a,r.rowIndex=c):r.msg=-1,r},x=()=>{if(i.value){const s=new FileReader;s.onload=a=>{const c=new Uint8Array(a.target.result);e.value=A(c,{type:"array"});const r=e.value.SheetNames[0],u=e.value.Sheets[r],p=E.sheet_to_json(u,{header:1}),l=f(p);console.log(l),l.msg==D?p.slice(l.rowIndex+1).map(_=>_[l.colIndex]).forEach(_=>{o.value.push({name:_,bgcolor:"white"})}):l.msg==K?alert("找不到姓名，曼莉姐，检查一下表格"):alert("报错了，请联系我")},s.readAsArrayBuffer(i.value)}},b=["red","blue","green","yellow","purple","orange","pink"],C=()=>{n.lotteryCount=0;const s=setInterval(()=>{const a=Math.floor(Math.random()*o.value.length),c=b[Math.floor(Math.random()*b.length)];o.value[a].bgcolor=c,o.value.forEach((r,u)=>{a!=u&&(r.bgcolor="white")}),n.lotteryCount++,n.lotteryCount>=10&&clearInterval(s)},150)};return(s,a)=>(h(),y("div",q,[m("div",null,[m("input",{type:"file",ref:"fileInput",onChange:t,accept:".xls,.xlsx"},null,544),m("button",{onClick:x},"处理Excel文件")]),m("button",{class:"btn",type:"button",onClick:C},"随机点名"),m("div",z,[(h(!0),y(N,null,O(o.value,(c,r)=>(h(),y("div",{key:r,class:"grid-item",style:F({backgroundColor:c.bgcolor})},M(c.name),5))),128))])]))}},$=w(W,[["__scopeId","data-v-0a6f59ef"]]),G=V({history:B(),routes:[{path:"/",name:"home",component:$}]}),v=H(U);v.use(P());v.use(G);v.mount("#app");
